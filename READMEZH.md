# 贺卡制作器 🎉

一个功能丰富的现代化 Web 应用程序，用于创建、自定义和分享精美的贺卡，具有高级文本样式和设计功能。

## ✨ 功能特性

### 核心功能
- 📚 **模板库** - 为不同场合提供多种预设计的贺卡模板
- 🎨 **交互式画布编辑器** - 直观的拖放界面，用于自定义贺卡
- 📄 **PDF 导出** - 以高质量可打印 PDF 格式下载贺卡（5x7 英寸）
- 🖼️ **图片导出** - 将贺卡导出为 PNG 图片
- 📧 **邮件电子贺卡** - 直接通过邮件发送数字贺卡
- 💾 **保存和加载** - 本地保存您的设计，稍后编辑
- 🎭 **多种场合** - 生日、圣诞节、周年纪念、感谢等

### 高级文本功能
- ✍️ **富文本编辑** - 添加和自定义文本，包括字体、大小、颜色、粗体和斜体
- 🎨 **艺术文本系统** - 8+ 种预设艺术文本样式，可自定义效果：
  - 渐变基础
  - 霓虹发光（可调节模糊强度）
  - 金属光泽
  - 火焰效果
  - 彩虹文本
  - 复古风格
  - 水晶玻璃
  - 漫画风格
- 🎭 **高级文本效果**：
  - 自定义字体上传（TTF, OTF, WOFF, WOFF2）
  - 艺术文本的图像纹理背景
  - 动态颜色同步（文本、阴影、滤镜和发光效果）
  - CSS 动画（发光、弹跳、脉冲、彩虹、闪烁）
  - 变换效果（旋转、缩放、倾斜）
  - 滤镜效果（模糊、亮度、对比度）
  - 文本装饰（下划线、上划线、删除线）
  - 字母间距和行高控制

### 设计元素
- 🖼️ **图片上传** - 添加自定义图片到贺卡，支持拖拽调整尺寸
- 🔷 **形状工具** - 添加矩形、圆形、三角形、箭头、星星和心形
- 🎨 **颜色自定义** - 背景、文本和形状的完整颜色选择器
- 🖼️ **背景图片** - 上传图片作为贺卡背景，支持大小、位置和重复控制
- 📐 **元素定位** - 拖放定位，精确控制
- 🔧 **调整元素尺寸** - 拖拽边缘和角落来调整任何元素（文本、图片、形状）的尺寸
- 📚 **图层管理** - 置于上层、置于下层、前移/后移所有元素
- 🔄 **撤销/重做** - 所有编辑的完整历史管理

## 🛠️ 技术栈

### 前端框架
- **React 18.2.0** - 使用 Hooks 的现代 UI 库
- **React Router DOM 6.20.0** - 客户端路由和导航
- **Vite 5.0.8** - 快速构建工具和开发服务器

### 库和工具
- **html2canvas 1.4.1** - DOM 到画布转换，用于导出功能
- **jsPDF 2.5.1** - PDF 生成和导出
- **Fabric.js 5.3.0** - 画布操作（用于未来增强）
- **Lucide React 0.294.0** - 现代图标库

### 浏览器 API
- **FontFace API** - 动态字体加载，用于自定义字体
- **FileReader API** - 本地文件读取，用于图片和字体
- **LocalStorage API** - 客户端数据持久化
- **Canvas API** - 图片渲染和导出

## 📁 项目结构

```
greeting-card-maker/
├── src/
│   ├── components/          # 可复用的 React 组件
│   │   ├── editor/         # 编辑器特定组件（模块化）
│   │   │   ├── EditorToolbar.jsx        # 工具栏，包含添加/导出按钮
│   │   │   ├── EditorSidebar.jsx        # 侧边栏容器
│   │   │   ├── EditorCanvas.jsx         # 画布区域
│   │   │   ├── ElementRenderer.jsx      # 元素渲染组件
│   │   │   ├── BackgroundControls.jsx   # 背景颜色控制
│   │   │   ├── TextPropertiesPanel.jsx  # 文本元素属性
│   │   │   ├── ArtTextPropertiesPanel.jsx  # 艺术文本属性
│   │   │   ├── ImagePropertiesPanel.jsx # 图片元素属性
│   │   │   ├── ShapePropertiesPanel.jsx # 形状元素属性
│   │   │   └── index.js                 # 统一导出
│   │   ├── Header.jsx      # 导航头部
│   │   ├── Footer.jsx      # 页脚组件
│   │   └── EmailModal.jsx  # 邮件发送模态框
│   │
│   ├── hooks/              # 自定义 React Hooks（新增）
│   │   ├── useCardData.js      # 贺卡数据管理
│   │   ├── useHistory.js        # 撤销/重做功能
│   │   ├── useDragAndDrop.js   # 拖放逻辑
│   │   ├── useNotification.js  # 通知系统
│   │   ├── useGlowStyles.js    # 发光动画样式
│   │   ├── useFontManager.js   # 自定义字体管理
│   │   └── useElementOperations.js  # 元素 CRUD 操作
│   │
│   ├── pages/               # 页面组件
│   │   ├── HomePage.jsx     # 首页，支持动态背景
│   │   ├── TemplateGallery.jsx  # 模板浏览
│   │   ├── CardEditor.jsx   # 主编辑器（重构，使用 hooks）
│   │   └── SavedDesigns.jsx # 已保存设计管理
│   │
│   ├── templates/           # 模板数据
│   │   ├── templateData.js      # 贺卡模板
│   │   └── artTextTemplates.js  # 艺术文本样式预设
│   │
│   ├── config/              # 配置文件
│   │   └── heroBackgrounds.js   # 首页 Hero 部分背景图片配置
│   │
│   ├── utils/              # 工具函数（模块化）
│   │   ├── colorUtils.js       # 颜色操作工具
│   │   ├── styleUtils.js       # 样式生成工具
│   │   ├── elementUtils.js     # 元素创建工具
│   │   ├── exportUtils.js      # PDF/图片导出
│   │   └── storageUtils.js      # LocalStorage 管理
│   │
│   ├── styles/             # 全局样式
│   │   ├── App.css         # 应用级样式
│   │   └── index.css       # 基础样式
│   │
│   ├── App.jsx              # 主应用组件，包含路由
│   └── main.jsx             # 应用程序入口点
│
├── public/                  # 静态资源
│   └── image/               # 首页 Hero 部分的背景图片
├── package.json             # 依赖和脚本
└── vite.config.js          # Vite 配置
```

## 🚀 安装与设置

### 前置要求

在开始之前，请确保已安装以下内容：
- **Node.js**（版本 16 或更高）
- **npm**（随 Node.js 一起安装）

### 安装步骤

#### 1. 安装依赖

在项目目录中打开终端并运行：

```bash
npm install
```

这将安装所有必需的依赖，包括：
- React 18
- React Router
- Fabric.js（画布操作）
- jsPDF（PDF 生成）
- html2canvas（渲染）
- Lucide React（图标）
- Vite（构建工具）

#### 2. 启动开发服务器

安装完成后，启动开发服务器：

```bash
npm run dev
```

应用程序将自动在默认浏览器中打开，地址为 `http://localhost:3000`

#### 3. 构建生产版本

创建生产构建：

```bash
npm run build
```

优化后的文件将在 `dist/` 目录中。

#### 4. 预览生产构建

在本地预览生产构建：

```bash
npm run preview
```

### 故障排除

#### 端口已被占用

如果端口 3000 已被占用，Vite 会自动尝试下一个可用端口（3001、3002 等）

#### 模块未找到错误

如果看到模块错误，请尝试：
```bash
# Windows/Linux/Mac
rm -rf node_modules package-lock.json
npm install
```

#### 清除浏览器缓存

如果看到过时内容，请清除浏览器缓存或使用：
- **Windows/Linux**: `Ctrl + Shift + R`
- **Mac**: `Cmd + Shift + R`

### 浏览器支持

- Chrome（推荐）
- Firefox
- Safari
- Edge

## 📖 用户指南

### 快速开始

#### 1. 首页

首次打开应用程序时，您会看到：
- 带有介绍的 Hero 部分
- 功能亮点
- 不同场合的类别卡片

**操作：**
- 点击"浏览模板"查看所有可用设计
- 点击"从空白开始"从头创建贺卡
- 点击任何类别卡片按场合筛选模板

#### 2. 模板库

浏览我们预设计的模板集合：

**功能：**
- 按类别筛选（生日、圣诞节、周年纪念等）
- 编辑前预览模板
- 每个模板上的快速"自定义"按钮

**可用类别：**
- 🎂 生日 - 丰富多彩的生日设计
- 🎄 圣诞节 - 节日问候
- 💕 周年纪念 - 浪漫庆祝贺卡
- 🙏 感谢 - 表达感激
- 🎉 祝贺 - 庆祝成就
- 🌸 早日康复 - 送上康复祝福
- 🎓 毕业 - 庆祝成就
- 💒 婚礼 - 庆祝爱情
- 🎨 空白画布 - 从头开始

### 创建贺卡

#### 1. 从模板或空白开始
   - 在 `/gallery` 浏览模板
   - 或在 `/editor` 从空白贺卡开始

#### 2. 贺卡编辑器概览

**工具栏（顶部）：**
- **添加文本** - 插入文本元素
- **添加艺术文本** - 插入带效果的艺术文本
- **添加图片** - 从设备上传照片
- **添加形状** - 添加矩形、圆形、三角形、箭头、星星、心形、线条
- **撤销/重做** - 浏览您的更改
- **保存** - 稍后存储您的设计
- **PDF** - 下载为可打印 PDF
- **邮件** - 作为电子贺卡发送

**侧边栏（左侧）：**

**背景部分：**
- 自定义颜色的颜色选择器
- 快速选择的预设颜色按钮
- 图片背景选项，支持大小、位置和重复控制

**元素属性**（选中元素时）：
- 文本属性：内容、字体、大小、颜色、样式
- 艺术文本属性：所有文本属性 + 效果、动画、变换
- 图片属性：宽度、高度、透明度
- 形状属性：颜色、大小、位置、透明度
- 图层顺序：置于上层、置于下层、前移、后移

**画布（中心）：**
- **点击**元素以选择它们
- **双击**文本进行编辑
- **拖拽**元素来移动它们
- **拖拽调整尺寸控制点**来调整元素大小
- 选中的元素显示调整尺寸控制点（元素周围的 8 个控制点）

#### 3. 使用元素

**添加文本：**
1. 点击"添加文本"按钮
2. 出现新的文本元素，显示"双击编辑"
3. 点击选择，然后在侧边栏编辑
4. 使用侧边栏自定义：
   - 更改文本内容
   - 调整字体大小（8-120px）和字体族
   - 更改颜色
   - 设置为粗体或斜体
5. 点击"应用更改"

**添加艺术文本：**
1. 点击"添加艺术文本"并选择样式模板
2. 从 8 种预设样式中选择（渐变、霓虹、金属、火焰等）
3. 在侧边栏中使用高级效果自定义
4. 应用动画、变换和滤镜

**添加图片：**
1. 点击"添加图片"按钮
2. 从计算机选择图片文件
3. 图片出现在贺卡上
4. 点击并拖拽来定位
5. 拖拽调整尺寸控制点来调整大小
6. 在侧边栏调整透明度

**添加形状：**
1. 点击"形状"下拉菜单
2. 选择形状类型（矩形、圆形、三角形、箭头、星星、心形、线条）
3. 形状出现在贺卡上
4. 在侧边栏自定义颜色、大小和透明度

**定位和调整尺寸：**
- 在画布上点击并拖拽元素来移动它们
- 拖拽调整尺寸控制点（选中元素周围的 8 个控制点）来调整大小
- 使用侧边栏的精确控件设置精确尺寸
- 元素可以独立调整大小（宽度和高度）

**管理图层：**
- 使用"置于上层"将元素移到顶层
- 使用"置于下层"将元素移到底层
- 使用"前移"向上移动一层
- 使用"后移"向下移动一层

#### 4. 自定义背景

**颜色背景：**
1. 使用颜色选择器选择任何颜色
2. 或点击预设颜色快速更改
3. 模板中的渐变会被保留

**图片背景：**
1. 在侧边栏选择"图片"作为背景类型
2. 上传图片文件
3. 调整大小（覆盖、包含、自动、拉伸）
4. 设置位置（居中、顶部、底部、左侧、右侧、角落）
5. 选择重复选项（不重复、重复、横向重复、纵向重复）
6. 设置图片加载时的后备颜色

#### 5. 保存您的工作

**保存设计：**
1. 点击工具栏中的"保存"按钮
2. 您的设计保存到浏览器存储
3. 稍后从"已保存"页面访问
4. 您将被重定向到已保存设计页面

**已保存设计页面：**
- 查看所有已保存的贺卡
- 查看每个贺卡的最后保存时间
- **编辑** - 继续处理设计
- **删除** - 删除不需要的设计
- 贺卡按最新优先排序

#### 6. 导出和分享

**导出为 PDF：**
1. 点击工具栏中的"PDF"按钮
2. 生成高质量 PDF（7" x 5"）
3. 文件自动下载
4. 在家打印或专业打印

**导出为图片：**
1. 点击"导出图片"按钮（如果可用）
2. 生成 PNG 图片
3. 文件自动下载

**作为电子贺卡发送：**
1. 点击"邮件"按钮
2. 填写表单：
   - **收件人邮箱**（必填）
   - 收件人姓名
   - 您的姓名
   - 个人消息
3. 点击"发送电子贺卡"
4. 默认邮件客户端打开，包含贺卡

**注意：** 邮件目前使用 `mailto:` 链接。在生产环境中，这将通过服务器直接发送。

### 艺术文本功能

1. **选择模板**
   - 从 8 种预设样式中选择
   - 每种都有独特的视觉效果

2. **自定义**
   - 更改文本内容
   - 调整字体族（包括自定义字体）
   - 更改颜色（与所有效果同步）
   - 上传背景图片
   - 调整字母间距
   - 选择动画（发光、弹跳、脉冲等）
   - 应用变换和滤镜

3. **发光动画**
   - 选择"发光"动画
   - 使用滑块调整模糊强度
   - 颜色自动匹配文本颜色

### 自定义字体

1. 在艺术文本属性中点击"上传字体"
2. 选择字体文件（TTF, OTF, WOFF, WOFF2）
3. 字体加载后可在字体选择器中使用
4. 应用于任何文本或艺术文本元素

### 提示与技巧

**设计提示：**
- **保持简洁** - 不要过度拥挤贺卡
- **对比度** - 为文本和背景使用对比色
- **层次结构** - 使主要消息更大
- **留白** - 在元素周围留出呼吸空间
- **字体配对** - 最多使用 2-3 种不同字体

**技术提示：**
- **撤销/重做** - 在实验时经常使用这些功能
- **经常保存** - 防止丢失工作
- **浏览器存储** - 如果有未保存的工作，不要清除浏览器数据
- **图片大小** - 使用合理大小的图片（2MB 以下）
- **预览** - 在导出前检查外观

### 常见用例

**生日贺卡：**
1. 转到模板 → 生日类别
2. 选择"多彩生日"或类似设计
3. 编辑文本中的姓名
4. 如果需要，添加照片
5. 更改颜色以匹配他们的个性
6. 导出为 PDF 或通过邮件发送

**感谢贺卡：**
1. 浏览感谢模板
2. 选择"简单感谢"
3. 自定义消息
4. 保持优雅和真诚
5. 保存并发送

**自定义设计：**
1. 从"空白画布"开始
2. 设置背景颜色或图片
3. 为消息添加文本元素
4. 上传图片或添加形状
5. 尝试字体和颜色
6. 根据需要调整和定位元素
7. 保存您的独特创作

### 故障排除

**元素无法选择：**
- 确保直接点击元素
- 尝试点击元素的中心
- 检查是否有另一个元素重叠

**无法编辑文本：**
- 首先点击选择元素
- 然后在侧边栏编辑
- 不要忘记点击"应用更改"

**图片太大：**
- 在上传前使用图片编辑软件调整大小
- 推荐：800px × 600px 或更小
- 格式：JPG、PNG、GIF

**设计无法保存：**
- 检查浏览器存储是否已满
- 尝试不同的浏览器
- 导出为 PDF 作为备份

**PDF 质量问题：**
- 使用更高分辨率的图片
- 避免非常小的文本
- 在导出前检查预览

**调整尺寸控制点不出现：**
- 确保元素已选中
- 检查元素在画布上是否完全可见
- 尝试再次点击元素

### 移动设备使用

应用程序具有响应式设计，可在移动设备上使用：
- 触摸选择元素
- 拖拽移动元素
- 捏合缩放（在画布上）
- 侧边栏在小屏幕上显示在下方
- 所有功能可用

### 数据和隐私

- **仅本地存储** - 所有数据保留在您的设备上
- **无需账户** - 立即开始创建
- **不收集数据** - 我们不跟踪或存储您的信息
- **浏览器相关** - 已保存的设计按浏览器存储

### 已知限制

1. **邮件功能**：使用 mailto 链接打开默认邮件客户端。在生产环境中，您将通过邮件服务 API（SendGrid、Mailgun 等）集成。

2. **图片存储**：上传的图片以 base64 格式存储在 localStorage 中，限制为 5-10MB。对于生产环境，请考虑云存储。

3. **无用户账户**：所有数据存储在本地。清除浏览器数据将删除已保存的设计。

### 首页 Hero 背景图片

**首页 Hero 部分：**
- 将图片放入 `public/image/` 文件夹
- 在 `src/config/heroBackgrounds.js` 中添加图片文件名
- 页面加载时会随机选择图片
- 如果未配置图片，将使用默认渐变背景

## 🎨 艺术文本模板

| 模板 | 类别 | 主要特性 |
|----------|----------|-------------|
| 渐变基础 | 渐变 | 纯色带阴影 |
| 霓虹发光 | 霓虹 | 动画发光效果 |
| 金属光泽 | 金属 | 金属外观 |
| 火焰效果 | 火焰 | 火焰般动画 |
| 彩虹文本 | 彩虹 | 多彩外观 |
| 复古风格 | 复古 | 复古样式 |
| 水晶玻璃 | 水晶 | 玻璃般透明 |
| 漫画风格 | 漫画 | 粗体漫画书风格 |

## 🏗️ 架构与实现

### 模块化架构（已重构）

代码库已重构为模块化架构，具有清晰的关注点分离：

#### **1. 自定义 Hooks 层** (`src/hooks/`)
封装业务逻辑和状态管理的可复用 hooks：

- **`useCardData`** - 管理贺卡数据加载和状态
- **`useHistory`** - 处理撤销/重做功能
- **`useDragAndDrop`** - 管理拖放交互
- **`useNotification`** - 通知系统
- **`useGlowStyles`** - 动态发光动画样式生成
- **`useFontManager`** - 自定义字体上传和管理
- **`useElementOperations`** - 元素 CRUD 操作和文本编辑

#### **2. 工具函数层** (`src/utils/`)
按领域组织的纯函数：

- **`colorUtils.js`** - 颜色操作（hex 转 RGB，颜色同步）
- **`styleUtils.js`** - CSS 样式生成（轮廓、发光动画）
- **`elementUtils.js`** - 元素工厂函数（创建文本、图片、形状、艺术文本）
- **`exportUtils.js`** - 导出功能（PDF、图片）
- **`storageUtils.js`** - LocalStorage 操作

#### **3. 组件层** (`src/components/`)
按功能和职责组织的 UI 组件：

**编辑器组件** (`src/components/editor/`):
- **`EditorToolbar.jsx`** - 工具栏，包含元素添加和导出按钮
- **`EditorSidebar.jsx`** - 侧边栏容器，根据选中的元素类型条件渲染属性面板
- **`EditorCanvas.jsx`** - 画布区域，渲染贺卡预览
- **`ElementRenderer.jsx`** - 渲染不同类型的元素（文本、艺术文本、图片、形状）
- **`BackgroundControls.jsx`** - 背景颜色选择器和预设
- **`TextPropertiesPanel.jsx`** - 文本元素属性控件
- **`ArtTextPropertiesPanel.jsx`** - 艺术文本元素属性控件
- **`ImagePropertiesPanel.jsx`** - 图片元素属性控件
- **`ShapePropertiesPanel.jsx`** - 形状元素属性控件

**布局组件**:
- **`Header.jsx`**, **`Footer.jsx`** - 布局组件
- **`EmailModal.jsx`** - 邮件功能

### 模块化架构的优势

1. **低耦合** - 每个模块都有单一职责，最小依赖
2. **高内聚** - 相关功能按逻辑分组
3. **可复用性** - Hooks 和工具可以在组件间复用
4. **可测试性** - 纯函数和隔离的 hooks/组件更容易测试
5. **可维护性** - 清晰的结构使代码更容易理解和修改
6. **可扩展性** - 易于添加新功能而不影响现有代码
7. **组件隔离** - 每个组件可以独立开发和测试

## 🔧 技术细节

### 颜色同步系统

**位置：** `src/utils/colorUtils.js`

当用户更改文本颜色时：
1. 艺术文本的 `webkitTextFillColor` 通过 `useElementOperations` 更新
2. `textShadow` 颜色通过 `updateTextShadowColor()` 替换
3. `filter` 颜色通过 `updateFilterColor()` 替换
4. 发光动画通过 `useGlowStyles` hook 重新生成
5. 所有效果在更新颜色时保持其结构

### 动态动画系统

**位置：** `src/utils/styleUtils.js` + `src/hooks/useGlowStyles.js`

- 每个带有发光动画的艺术文本元素获得唯一 ID
- CSS `@keyframes` 通过 `generateGlowAnimation()` 在运行时生成
- 动画通过 `useGlowStyles` hook 自动注入
- 颜色值从元素属性中提取
- 模糊强度可通过滑块调整

### 导出系统

**位置：** `src/utils/exportUtils.js`

- 使用 `html2canvas` 将 DOM 捕获为画布
- 2x 缩放以获得高质量输出
- PDF：5x7 英寸横向格式
- PNG：全分辨率图片
- 邮件：嵌入 Base64 数据 URL

### 存储系统

**位置：** `src/utils/storageUtils.js`

- 使用浏览器 LocalStorage
- 贺卡数据的 JSON 序列化
- 时间戳跟踪
- 已保存设计的 CRUD 操作

### 元素管理系统

**位置：** `src/utils/elementUtils.js` + `src/hooks/useElementOperations.js`

- 创建元素的工厂函数（`createTextElement`, `createImageElement` 等）
- 元素操作 hook 管理 CRUD 操作
- 文本编辑逻辑封装在 hook 中
- 颜色同步自动处理

## 🎯 未来增强

- [ ] 用户账户和云存储
- [ ] 更多模板设计
- [ ] 高级编辑工具（滤镜、贴纸）
- [ ] 社交媒体分享
- [ ] 实体打印的支付集成
- [ ] 协作编辑
- [ ] 实时预览
- [ ] 移动应用版本

## 📝 许可证

MIT 许可证 - 欢迎将此项目用于学习和开发目的。

## 👥 贡献

欢迎贡献！请随时提交 Pull Request。

---

**使用 React、Vite 和现代 Web 技术构建 ❤️**

